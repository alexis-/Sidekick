<map version="0.7.1"><node ID="1" TEXT="Sched.answerCard&#x28;Card&#x2C;&#x20;int&#x29;"><node ID="4" TEXT="increase&#x20;reps"><node ID="2" TEXT="if&#x20;&#x28;BurySiblingOnAnswer&#x29;&#x20;burySiblings&#x28;card&#x29;"><node ID="8" TEXT="if&#x20;&#x28;wasNew&#x29;&#x20;//&#x20;queue&#x20;&#x3D;&#x20;0"><node ID="11" TEXT="setQueue&#x28;1&#x29;"><node ID="12" TEXT="if&#x20;&#x28;type&#x20;&#x3D;&#x20;0&#x29;&#x20;type&#x20;&#x3D;&#x20;1"><node ID="13" TEXT="setLeft&#x28;initial&#x20;val&#x29;"><node ID="17" TEXT="endif"><node ID="9" TEXT="if&#x20;&#x28;queue&#x20;IN&#x20;1&#x2C;3&#x29;&#x20;//&#x20;learning"><node ID="15" TEXT="_answerLrnCard&#x28;card&#x2C;&#x20;ease&#x29;"><node ID="112" TEXT="&#x28;impl&#x29;"><node ID="18" TEXT="if&#x20;&#x28;ease&#x20;&#x3D;&#x20;3&#x29;&#x20;//&#x20;easy"><node ID="20" TEXT="_rescheduleAsRev&#x28;card&#x2C;&#x20;conf&#x2C;&#x20;true&#x29;"><node ID="44" TEXT="&#x28;Impl&#x29;"><node ID="42" TEXT="else&#x20;//&#x20;review"><node ID="43" TEXT="_rescheduleNew&#x28;card&#x2C;&#x20;conf&#x2C;&#x20;early&#x29;"><node ID="107" TEXT="&#x28;impl&#x29;"><node ID="83" TEXT="setIvl&#x28;_graduatingIvl&#x28;card&#x2C;&#x20;conf&#x2C;&#x20;early&#x2C;&#x20;adjust&#x20;&#x3D;&#x20;false&#x29;&#x29;"><node ID="106" TEXT="&#x28;impl&#x29;"><node ID="87" TEXT="if&#x20;&#x28;type&#x20;&#x3D;&#x20;2&#x29;&#x20;//&#x20;lapsed&#x20;card"><node ID="89" TEXT="return&#x20;card.getInterval&#x28;&#x29;"><node ID="90" TEXT="endif"><node ID="92" TEXT="if&#x20;&#x28;adjust&#x29;"><node ID="93" TEXT="return&#x20;_fuzzedIvl&#x28;&#x22;ints&#x22;&#x5B;early&#x20;&#x3F;&#x20;1&#x20;&#x3A;&#x20;0&#x5D;&#x29;"></node></node><node ID="94" TEXT="else"><node ID="95" TEXT="return&#x20;&#x22;ints&#x22;&#x5B;early&#x20;&#x3F;&#x20;1&#x20;&#x3A;&#x20;0&#x5D;"></node></node></node></node></node></node><node ID="84" TEXT="setDue&#x28;today&#x20;+&#x20;interval&#x29;"><node ID="86" TEXT="setFactor&#x28;initialFactor&#x29;"></node></node></node></node></node></node><node ID="38" TEXT="if&#x20;&#x28;type&#x20;&#x3D;&#x20;2&#x29;&#x20;//&#x20;lapse"><node ID="39" TEXT="setDue&#x28;Math.max&#x28;mToday&#x20;+&#x20;1&#x2C;&#x20;card.getODue&#x28;&#x29;&#x29;&#x29;"><node ID="40" TEXT="setODue&#x28;0&#x29;"><node ID="41" TEXT="endif"><node ID="49" TEXT="setQueue&#x28;2&#x29;"><node ID="50" TEXT="setType&#x28;2&#x29;"></node></node></node></node></node></node></node></node></node><node ID="19" TEXT="elif&#x20;&#x28;ease&#x20;&#x3D;&#x20;2&#x20;&#x26;&#x20;graduating&#x29;&#x20;//&#x20;good"><node ID="25" TEXT="_rescheduleAsRev&#x28;card&#x2C;&#x20;conf&#x2C;&#x20;false&#x29;"><node ID="29" TEXT="endif"><node ID="36" TEXT="if&#x20;&#x28;due&#x20;&#x3C;&#x20;now&#x29;"><node ID="51" TEXT="addRandomness&#x28;25&#x25;&#x29;"><node ID="52" TEXT="endif"><node ID="54" TEXT="setDue&#x28;nextLearnDelay&#x29;"><node ID="55" TEXT="if&#x20;&#x28;dueToday&#x29;"><node ID="59" TEXT="setQueue&#x28;1&#x29;"><node ID="62" TEXT="if&#x20;&#x28;noRev&#x20;&#x26;&#x20;noNew&#x20;&#x26;&#x20;isLrn&#x29;"><node ID="64" TEXT="makeSureCurCardNotFirst"><node ID="65" TEXT="endif"></node></node></node></node></node><node ID="66" TEXT="else&#x20;//&#x20;due&#x20;another&#x20;day"><node ID="69" TEXT="setQueue&#x28;3&#x29;&#x20;//&#x20;dayLearnQueue"><node ID="71" TEXT="setDue&#x28;daysFromToday&#x29;"></node></node></node></node></node></node></node></node></node></node><node ID="22" TEXT="else"><node ID="23" TEXT="if&#x20;&#x28;ease&#x20;&#x3D;&#x20;2&#x29;&#x20;//&#x20;good"><node ID="26" TEXT="setLeft&#x28;-1&#x29;"><node ID="75" TEXT="endif"></node></node></node><node ID="24" TEXT="else&#x20;//&#x20;fail&#x20;or&#x20;lapse"><node ID="27" TEXT="setLeft&#x28;initial&#x20;val&#x29;"><node ID="31" TEXT="if&#x20;&#x28;review&#x29;"><node ID="34" TEXT="card.setIvl&#x28;Math.max&#x28;Math.max&#x28;1&#x2C;&#x20;card.getIvl&#x28;&#x29;&#x20;*&#x20;&#x22;mult&#x22;&#x29;&#x2C;&#x20;&#x22;minInt&#x22;&#x29;&#x29;"><node ID="35" TEXT="endif"><node ID="77" TEXT="endif"></node></node></node></node></node></node></node></node></node></node><node ID="72" TEXT="setMod"><node ID="76" TEXT="setUsn"></node></node><node ID="10" TEXT="elif&#x20;&#x28;queue&#x20;&#x3D;&#x20;2&#x29;&#x20;//&#x20;review"><node ID="16" TEXT="_answerRevCard&#x28;card&#x2C;&#x20;ease&#x29;"><node ID="110" TEXT="&#x28;impl&#x29;"><node ID="78" TEXT="if&#x20;&#x28;ease&#x20;&#x3D;&#x20;0&#x29;&#x20;//&#x20;lapse"><node ID="81" TEXT="_rescheduleLapse&#x28;card&#x29;"><node ID="109" TEXT="&#x28;impl&#x29;"><node ID="99" TEXT="setLastInterval&#x28;&#x29;"><node ID="100" TEXT="increaseLapse&#x28;&#x29;"><node ID="101" TEXT="setInterval&#x28;_nextLapseIvl&#x28;card&#x2C;&#x20;conf&#x29;&#x29;"><node ID="105" TEXT="&#x28;impl&#x29;"><node ID="108" TEXT="return&#x20;Max&#x28;&#x22;minInt&#x22;&#x2C;&#x20;getInterval&#x28;&#x29;&#x20;*&#x20;&#x22;mult&#x22;&#x29;"></node></node><node ID="103" TEXT="setFactor&#x28;Max&#x28;&#x22;minInt&#x22;&#x2C;&#x20;interval&#x20;-&#x20;200&#x29;&#x29;"><node ID="104" TEXT="setDue&#x28;today&#x20;+&#x20;interval&#x29;"><node ID="114" TEXT="if&#x20;&#x28;&#x28;_checkLeech&#x28;card&#x29;&#x20;&#x26;&#x20;queue&#x20;&#x3D;&#x3D;&#x20;-1&#x29;&#x20;&#x7C;&#x7C;&#x20;&#x22;delays&#x22;&#x20;not&#x20;set&#x29;"><node ID="115" TEXT="return&#x20;0"><node ID="116" TEXT="endif"><node ID="117" TEXT="if&#x20;&#x28;ODue&#x20;&#x3D;&#x20;0&#x29;"><node ID="119" TEXT="setODue&#x28;getDue&#x28;&#x29;&#x29;"><node ID="120" TEXT="endif"><node ID="139" TEXT="setLeft&#x28;initialVal&#x29;"><node ID="150" TEXT="setDue&#x28;nextLearnDelay&#x29;"><node ID="151" TEXT="if&#x20;&#x28;dueToday&#x29;"><node ID="152" TEXT="setQueue&#x28;1&#x29;"><node ID="153" TEXT="if&#x20;&#x28;noRev&#x20;&#x26;&#x20;noNew&#x20;&#x26;&#x20;isLrn&#x29;"><node ID="154" TEXT="makeSureCurCardNotFirst"><node ID="155" TEXT="endif"></node></node></node></node></node><node ID="156" TEXT="else&#x20;//&#x20;due&#x20;another&#x20;day"><node ID="157" TEXT="setQueue&#x28;3&#x29;&#x20;//&#x20;dayLearnQueue"><node ID="158" TEXT="setDue&#x28;daysFromToday&#x29;"></node></node></node></node></node></node></node></node></node></node><node ID="122" TEXT="&#x28;impl&#x29;"><node ID="123" TEXT="checkLeechValSet&#x28;&#x29;"><node ID="126" TEXT="if&#x20;&#x28;lapses&#x20;&#x3E;&#x3D;&#x20;leechVal&#x20;&#x7C;&#x7C;&#x20;halfThresholdAfter&#x29;"><node ID="127" TEXT="setLeech&#x28;&#x29;"><node ID="128" TEXT="if&#x20;&#x28;&#x22;leechAction&#x22;&#x20;&#x3D;&#x20;0&#x29;&#x20;//&#x20;suspend"><node ID="129" TEXT="if&#x20;&#x28;ODue&#x20;&#x21;&#x3D;&#x20;0&#x29;"><node ID="130" TEXT="setDue&#x28;ODue&#x29;"><node ID="131" TEXT="endif"><node ID="132" TEXT="setODue&#x28;0&#x29;"><node ID="133" TEXT="setQueue&#x28;-1&#x29;"><node ID="135" TEXT="endif"><node ID="136" TEXT="return&#x20;true"><node ID="137" TEXT="endif"><node ID="138" TEXT="return&#x20;false"></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node><node ID="79" TEXT="else&#x20;//&#x20;review"><node ID="80" TEXT="_rescheduleRev&#x28;card&#x2C;&#x20;ease&#x29;"><node ID="113" TEXT="&#x28;impl&#x29;"><node ID="159" TEXT="setLastInterval&#x28;&#x29;"><node ID="160" TEXT="_updateRevIvl&#x28;card&#x2C;&#x20;ease&#x29;"><node ID="161" TEXT="setFactor&#x28;Max&#x28;&#x22;minIvl&#x22;&#x2C;&#x20;&#x7B;-150&#x2C;&#x20;0&#x2C;&#x20;150&#x7D;&#x5B;ease&#x20;-&#x20;2&#x5D;&#x29;&#x29;"><node ID="162" TEXT="setDue&#x28;today&#x20;+&#x20;interval&#x29;"></node></node><node ID="163" TEXT="&#x28;impl&#x29;"><node ID="164" TEXT="setIvl&#x28;_fuzzedIvl&#x28;_nextRevIvl&#x28;card&#x2C;&#x20;ease&#x29;&#x29;"><node ID="165" TEXT="&#x28;impl&#x29;"></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></node></map>